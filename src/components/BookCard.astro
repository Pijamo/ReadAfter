---
interface Props {
  slug: string;
  title: string;
  author: string;
  coverImage: string;
  rating: number;
  genres: string[];
  amazonUrl: string;
}

const { slug, title, author, coverImage, rating, genres, amazonUrl } = Astro.props;

const stars = '★'.repeat(Math.round(rating)) + '☆'.repeat(5 - Math.round(rating));
---

<article class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow group">
  <a href={`/books/${slug}/`} class="block">
    <div class="aspect-[2/3] bg-gray-100 overflow-hidden">
      <img
        src={coverImage}
        alt={`${title} by ${author} - Book Cover`}
        class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
        loading="lazy"
      />
    </div>
  </a>
  <div class="p-4">
    <div class="flex flex-wrap gap-1 mb-2">
      {genres.slice(0, 2).map((genre) => (
        <span class="text-xs bg-primary-50 text-primary-700 px-2 py-0.5 rounded-full">{genre}</span>
      ))}
    </div>
    <a href={`/books/${slug}/`} class="block">
      <h3 class="font-semibold text-gray-900 leading-snug line-clamp-2 group-hover:text-primary-700 transition-colors">{title}</h3>
    </a>
    <p class="text-sm text-gray-500 mt-1">{author}</p>
    <div class="flex items-center justify-between mt-3">
      <span class="text-amber-500 text-sm" title={`${rating} out of 5`}>{stars}</span>
      <a
        href={amazonUrl}
        target="_blank"
        rel="nofollow noopener sponsored"
        class="text-xs font-medium bg-amber-500 text-white px-3 py-1 rounded-full hover:bg-amber-600 transition-colors"
      >
        Buy Now
      </a>
    </div>
  </div>
</article>
